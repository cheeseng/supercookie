<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Super Cookies - Basic Example</title>
<script src="../js/swfobject/swfobject.js" type="text/javascript"></script>
<script>
//for setting cross domain cookies
//1. cookienName should be same
//2. crossDomainShould be enabled
//3. swfURL : URL of the other site. (site A)
var superCookieSetup = {cookieName:"mscookie", crossDomain:true, swfURL:"http://www.marghoobsuleman.com/mywork/jcomponents/SuperCookie/swf/supercookie.swf", expressInstaller:"../js/swfobject/expressInstall.swf"};
</script>
<script src="../js/superCookie-min.js" type="text/javascript"></script>
<style type="text/css">
body{font-family:"Palatino Linotype", "Book Antiqua", Palatino, serif; font-size:14px; background:#fff} 
.small {
    color: #fff;
    font-family: Arial,Helvetica,sans-serif;
    font-size: 10px;
    font-weight: normal;
    line-height: 12px;
    position: relative;
    top: -10px;
}
ol li{margin-bottom:10px;}
ul li{margin-bottom:0px;}
h1, h2, h3{margin:0; padding:0}
.topmenu{}
.topmenu td{background:#333; color:#FFFFFF; text-align:center}
.topmenu td a, .topmenu td a:visited{color:#fff;}
.topmenu td.active{background:#090; color:#333}
.topmenu td.active a, .topmenu td.active a:visited{color:#fff; text-decoration:none}
.tblWhite{background:#FFFFFF}
pre{overflow-x:auto; overflow-y:hidden; background:#707070; color:#fff; margin:0; padding:20px; max-width:750px}
.hide, .hidden{display:none}
code.blue{color:#993300}
</style>

</head>
<body onload="getCookie()">

<table width="100%" border="0" cellspacing="1" cellpadding="5" class="topmenu help">
  <tr>
    <td colspan="4" align="center" class="title"><h1>Javascript Super Cookie<span id="ver"></span> <a title="Download" href="http://www.marghoobsuleman.com/cross-domain-cookies" class="small">Download</a></h1></td>
  </tr>
  <tr>
    <td><a href="index.html">Basic</a></td>
    <td><a href="multiple-items.html">Save Objects/Data Types</a></td>
    <td class="active"><a href="cross-domain.html">Cross Domain</a></td>
    <td align="left"><a href="help.html">Documentation</a></td>
  </tr>
</table>
<p>&nbsp;</p>
<h2>Setup for corss domain cookies access. - Site A</h2>
<ol>
  <li>Add the following script in header. Please check your js folder path.
    <pre>
<code>
//in header
&lt;script src="../js/swfobject/swfobject.js" type="text/javascript">&lt;/script>
&lt;script>
var superCookieSetup = {cookieName:"mscookie", crossDomain:true, swfURL:"../swf/supercookie.swf", expressInstaller:"../js/swfobject/expressInstall.swf"};
&lt;/script>
&lt;script src="../js/superCookie-min.js" type="text/javascript">&lt;/script>
</code>
</pre>
    </li>
  <li>Add following div in your page. (anywhere inside <code class="blue">&lt;Body></code> tag). Please dont change the id.
    <pre><code>&lt;div id="msCookieDiv">&lt;/div></code></pre>
    </li>
  <li>And you are done. Really? Yes/No. Its 50-50</li>
  <li><strong>Most important notes:</strong>
    	<ul>        	        	 
            <li>Dont change the variable name <code class="blue">superCookieSetup</code> and div id <code class="blue">msCookieDiv</code></li>
            <li>You need to place crossdomain.xml file in your root directory.</li>
            <li>You need to grant permission to the domain. See the code below for an example for crossdomain.xml.
<pre>
<code>&lt;cross-domain-policy>
&lt;allow-access-from domain="*.marghoobsuleman.com"/>
&lt;allow-access-from domain="www.marghoobsuleman.com"/>
&lt;/cross-domain-policy></code></pre>
            </li>            
        </ul>
    </li>
</ol>

<h2>Setup for cross domain cookies access - Site B</h2>
<span>Please note: <strong>Site B</strong> wants to access cookies from <strong>Site A</strong></span>
<ol>
<li>Most important notes first - Cross domain cookies only works if following conditions are matched.
	<ul>
    <li>Cookie name (<code class="blue">cookieName</code>) should be same on the both domain.</li>
    <li>You must load the swf from the <strong>Site A</strong>. So you need to know swf file location (<code class="blue">swfURL</code>) of <strong>Site A</strong></li>    
    <li>And <strong>Site A</strong> has given permission to access cookie using crossdomain.xml file. <strong>Site B</strong> does not need crossdomain.xml. Only <strong>Site A</strong> needs.</li>
	</ul>
</li>
<li>Setup - Please note <code class="blue">cookieName</code> and <code class="blue">swfURL</code>
    <pre>
<code>
//in header
&lt;script src="../js/swfobject/swfobject.js" type="text/javascript">&lt;/script>
&lt;script>
var superCookieSetup = {cookieName:"mscookie", crossDomain:true, swfURL:"http://siteA.com/swf/supercookie.swf", expressInstaller:"../js/swfobject/expressInstall.swf"};
&lt;/script>
&lt;script src="../js/superCookie-min.js" type="text/javascript">&lt;/script>
</code>
</pre>
</li>
<li>Add following div in your page. (anywhere inside <code class="blue">&lt;Body></code> tag). Please dont change the id. 
  <pre><code>&lt;div id=&quot;msCookieDiv&quot;&gt;&lt;/div&gt;</code></pre>
</li>
</ol>
<script type="text/javascript">
function setCookie() {
	var obj = {};
	for(var i=0;i<elements.length;i++) {
		obj[elements[i]] = document.getElementById(elements[i]).value;
	}
	//console.log(obj);
	superCookie.setItem("crossed", obj);
	//just for feedback
	document.getElementById("status").innerHTML = "<span style='color:green'>Cookie has been set. <a href='http://www.marghoobsuleman.com/mywork/jcomponents/SuperCookie/examples/cross-domain.html#m_name' target='_blank'>Click here to see.</a></span>"
}
function getCookie() {
	if(superCookie.isReady) {
		var val = superCookie.getItem("crossed");	
		updateField(val);
	} else {
		superCookie.onReady(function() {
			var val = superCookie.getItem("crossed");
			updateField(val);
		})		
	}
	function updateField(val) {
		for(var i=0;i<elements.length;i++) {
			document.getElementById(elements[i]).value = val[elements[i]];
		}	
	}
}
var elements = ["m_name","m_city","m_country"];
</script>
<fieldset>
  <legend><strong>Set Cookie for cross domain</strong></legend>
  <table width="100%" border="0" cellspacing="1" cellpadding="5">
  <tr>
    <td width="9%">Name:</td>
    <td width="91%"><input type="text" name="m_name" id="m_name" value="" /></td>
  </tr>
  <tr>
    <td>City: </td>
    <td><input type="text" name="m_city" id="m_city" value="" /></td>
  </tr>
  <tr>
    <td>Country: </td>
    <td><input type="text" name="m_country" id="m_country" value="" /></td>
  </tr>
  <tr>
    <td>&nbsp;</td>
    <td><input type="button" onclick="setCookie()" value="Set Super Cookie" /></td>
  </tr>
</table>
<div id="status" style="padding:10px 0;"> Click on button to set the cookie. </div>
</fieldset>

<!-- supercookie div -->
<div id="msCookieDiv"></div>
<!-- supercookie div -->
</body>
</html>
